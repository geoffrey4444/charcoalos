// Distributed under the MIT license.
// See LICENSE.txt for details.

#pragma once

/*!
 * \brief Exception types for ARM64.
 */
enum {
  EXCEPTION_TYPE_SYNC_EL1_SP0,
  EXCEPTION_TYPE_IRQ_EL1_SP0,
  EXCEPTION_TYPE_FIQ_EL1_SP0,
  EXCEPTION_TYPE_SERROR_EL1_SP0,
  EXCEPTION_TYPE_SYNC_EL1_SPX,
  EXCEPTION_TYPE_IRQ_EL1_SPX,
  EXCEPTION_TYPE_FIQ_EL1_SPX,
  EXCEPTION_TYPE_SERROR_EL1_SPX,
  EXCEPTION_TYPE_SYNC_EL0_64,
  EXCEPTION_TYPE_IRQ_EL0_64,
  EXCEPTION_TYPE_FIQ_EL0_64,
  EXCEPTION_TYPE_SERROR_EL0_64,
  EXCEPTION_TYPE_SYNC_EL0_32,
  EXCEPTION_TYPE_IRQ_EL0_32,
  EXCEPTION_TYPE_FIQ_EL0_32,
  EXCEPTION_TYPE_SERROR_EL0_32
};

/*!
 * \brief Exception classes for ARM64.
 * \details These are the values of bits [31:26] of the ESR_EL1.
 * Generated by ChatGPT and corrected by me
 */
enum {
  EXCEPTION_CLASS_UNKNOWN                              = 0x00, /* 0b000000 */
  EXCEPTION_CLASS_TRAPPED_WFI_WFE                      = 0x01, /* 0b000001 */

  EXCEPTION_CLASS_TRAPPED_MCR_MRC_CP15                 = 0x03, /* 0b000011 */
  EXCEPTION_CLASS_TRAPPED_MCRR_MRRC_CP15               = 0x04, /* 0b000100 */
  EXCEPTION_CLASS_TRAPPED_MCR_MRC_CP14                 = 0x05, /* 0b000101 */
  EXCEPTION_CLASS_TRAPPED_LDC_STC                      = 0x06, /* 0b000110 */

  EXCEPTION_CLASS_TRAPPED_SIMD_FP_SVE_SME              = 0x07, /* 0b000111 */
  EXCEPTION_CLASS_TRAPPED_POINTER_AUTHENTICATION       = 0x09, /* 0b001001 */
  EXCEPTION_CLASS_TRAPPED_OTHER_INSTRUCTION            = 0x0A, /* 0b001010 */
  EXCEPTION_CLASS_TRAPPED_MRRC_CP14                    = 0x0C, /* 0b001100 */

  EXCEPTION_CLASS_BRANCH_TARGET                        = 0x0D, /* 0b001101 */
  EXCEPTION_CLASS_ILLEGAL_EXECUTION_STATE              = 0x0E, /* 0b001110 */

  EXCEPTION_CLASS_SVC_AARCH32                          = 0x11, /* 0b010001 */

  EXCEPTION_CLASS_TRAPPED_SYSREG128_SYSINSTR128        = 0x14, /* 0b010100 */
  EXCEPTION_CLASS_SVC_AARCH64                          = 0x15, /* 0b010101 */

  EXCEPTION_CLASS_TRAPPED_MSR_MRS_SYSTEM_AARCH64       = 0x18, /* 0b011000 */
  EXCEPTION_CLASS_TRAPPED_SVE                          = 0x19, /* 0b011001 */
  EXCEPTION_CLASS_TRAPPED_ERET_ERETAA_ERETAB           = 0x1A, /* 0b011010 */
  EXCEPTION_CLASS_PAC_FAIL                             = 0x1C, /* 0b011100 */
  EXCEPTION_CLASS_TRAPPED_SME                          = 0x1D, /* 0b011101 */

  EXCEPTION_CLASS_INSTRUCTION_ABORT_LOWER_EL           = 0x20, /* 0b100000 */
  EXCEPTION_CLASS_INSTRUCTION_ABORT_SAME_EL            = 0x21, /* 0b100001 */
  EXCEPTION_CLASS_PC_ALIGNMENT_FAULT                   = 0x22, /* 0b100010 */

  EXCEPTION_CLASS_DATA_ABORT_LOWER_EL                  = 0x24, /* 0b100100 */
  EXCEPTION_CLASS_DATA_ABORT_SAME_EL                   = 0x25, /* 0b100101 */
  EXCEPTION_CLASS_SP_ALIGNMENT_FAULT                   = 0x26, /* 0b100110 */

  EXCEPTION_CLASS_MEMORY_OPERATION                     = 0x27, /* 0b100111 */
  EXCEPTION_CLASS_TRAPPED_FP_EXCEPTION_AARCH32         = 0x28, /* 0b101000 */
  EXCEPTION_CLASS_TRAPPED_FP_EXCEPTION_AARCH64         = 0x2C, /* 0b101100 */
  EXCEPTION_CLASS_GCS                                  = 0x2D, /* 0b101101 */
  EXCEPTION_CLASS_SERROR                               = 0x2F, /* 0b101111 */

  EXCEPTION_CLASS_BREAKPOINT_LOWER_EL                  = 0x30, /* 0b110000 */
  EXCEPTION_CLASS_BREAKPOINT_SAME_EL                   = 0x31, /* 0b110001 */
  EXCEPTION_CLASS_SOFTWARE_STEP_LOWER_EL               = 0x32, /* 0b110010 */
  EXCEPTION_CLASS_SOFTWARE_STEP_SAME_EL                = 0x33, /* 0b110011 */
  EXCEPTION_CLASS_WATCHPOINT_LOWER_EL                  = 0x34, /* 0b110100 */
  EXCEPTION_CLASS_WATCHPOINT_SAME_EL                   = 0x35, /* 0b110101 */

  EXCEPTION_CLASS_BKPT_AARCH32                         = 0x38, /* 0b111000 */
  EXCEPTION_CLASS_BRK_AARCH64                          = 0x3C, /* 0b111100 */
  EXCEPTION_CLASS_PROFILING                            = 0x3D  /* 0b111101 */
};
